package em.emtests.split_classes;
/**
* LICENSE DISCLAIMER
* This file has been generated by EvoMaster.
* The content of this file is not subject to the license of EvoMaster itself, i.e., LGPL.
* This generated software (i.e., the test suite in this file) can be freely used, modified, 
* and distributed as you see fit without any restrictions.
*/
import  org.junit.jupiter.api.AfterAll;
import  org.junit.jupiter.api.BeforeAll;
import  org.junit.jupiter.api.BeforeEach;
import  org.junit.jupiter.api.Test;
import  org.junit.jupiter.api.Timeout;
import static org.junit.jupiter.api.Assertions.*;
import  java.util.Map;
import  java.util.Arrays;
import  java.util.List;
import static org.evomaster.test.utils.EMTestUtils.*;
import  org.evomaster.client.java.controller.SutHandler;
import  io.restassured.RestAssured;
import static io.restassured.RestAssured.given;
import  io.restassured.response.ValidatableResponse;
import static org.evomaster.client.java.controller.mongo.dsl.MongoDsl.mongo;
import  org.evomaster.client.java.controller.api.dto.database.operations.MongoInsertionResultsDto;
import  org.evomaster.client.java.controller.api.dto.database.operations.MongoInsertionDto;
import static org.hamcrest.Matchers.*;
import  io.restassured.config.JsonConfig;
import  io.restassured.path.json.config.JsonPathConfig;
import static io.restassured.config.RedirectConfig.redirectConfig;
import static org.evomaster.client.java.controller.contentMatchers.NumberMatcher.*;
import static org.evomaster.client.java.controller.contentMatchers.StringMatcher.*;
import static org.evomaster.client.java.controller.contentMatchers.SubStringMatcher.*;




/**
*  This file was automatically generated by EvoMaster on 2025-09-03T21:43:27.165-04:00[America/New_York]
 * <br>
*  The generated test suite contains 408 tests
 * <br>
*  Covered targets: 2217
 * <br>
*  Used time: 1h 5m 2s
 * <br>
*  Needed budget for current results: 99%
 * <br>
*  
*/

public class EM_gestaohospitaldefault_1234_Test_362_test_362_postOnCheckoutReturnsMismatchResponseWithSchema {
    

    
    private static final SutHandler controller = new em.external.br.com.codenation.hospital.ExternalEvoMasterController("/home/rhuang329/coaster/EMB/exp2/gestaohospital-sut.jar");
    private static String baseUrlOfSut;

    @BeforeAll
    public static void initClass() {
        controller.setupForGeneratedTest();
        baseUrlOfSut = controller.startSut();
        controller.registerOrExecuteInitSqlCommandsIfNeeded();
        assertNotNull(baseUrlOfSut);
        RestAssured.enableLoggingOfRequestAndResponseIfValidationFails();
        RestAssured.useRelaxedHTTPSValidation();
        RestAssured.urlEncodingEnabled = false;
        RestAssured.config = RestAssured.config()
            .jsonConfig(JsonConfig.jsonConfig().numberReturnType(JsonPathConfig.NumberReturnType.DOUBLE))
            .redirect(redirectConfig().followRedirects(false));
    }

    @AfterAll
    public static void tearDown() {
        controller.stopSut();
    }

    @BeforeEach
    public void initTest() {
        controller.resetStateOfSUT();
    }

    /**
    * Calls:
    * 1 - (400) GET:/v1/hospitais/{id}/leitos
    * 2 - (400) DELETE:/v1/hospitais/{hospital_id}
    * 3 - (400) GET:/v1/hospitais/{id}/leitos
    * 4 - (404) POST:/v1/hospitais/{hospital_id}/pacientes/checkout
    * Found 3 potential faults of type-code 101
    */
    @Test @Timeout(60)
    public void test_362_postOnCheckoutReturnsMismatchResponseWithSchema() throws Exception {
        List<MongoInsertionDto> insertions = mongo().insertInto("HospitalDB", "hospital_collection")
                .d("{\"id\":\"g9IsScP\", \"name\":\"GBQjUsGQu7bSAb5I\", \"address\":\"gp4eolm2ZR\", \"beds\":{\"$numberInt\":\"287\"}, \"availableBeds\":{\"$numberInt\":\"124\"}, \"location\":{\"id\":\"un8zjzR_UfGID\", \"name\":\"_O2XgbfXWo\", \"referenceId\":\"r2x\", \"locationCategory\":\"PATIENT\", \"position\":{\"coordinates\":[{\"$numberDouble\":\"0.6576332702570561\"}, {\"$numberDouble\":\"0.38917739785471384\"}], \"type\":\"Point\"}}, \"patients\":[{\"id\":\"oSZM3yPxA4S88\", \"name\":\"C4KnHyKqPXMbNRU\", \"cpf\":\"H1NeG\", \"birthDate\":{\"$date\":{\"$numberLong\":\"-1285700400000\"}}, \"gender\":\"vlRaqG\", \"entryDate\":{\"$date\":{\"$numberLong\":\"912747600000\"}}, \"exitDate\":{\"$date\":{\"$numberLong\":\"148708800000\"}}, \"active\":true, \"location\":{\"id\":\"CLaA\", \"name\":\"T\", \"referenceId\":\"vFH4ZjLLSJHXmYWC\", \"locationCategory\":\"HOSPITAL\", \"position\":{\"coordinates\":[{\"$numberDouble\":\"0.3359202333426089\"}, {\"$numberDouble\":\"0.37520207043141807\"}], \"type\":\"Point\"}}}], \"products\":[], \"_id\":{\"$oid\":\"ebc03eb18a1fe6c90af9d1fc\"}}")
            .and().insertInto("HospitalDB", "hospital_collection")
                .d("{\"id\":\"qweg\", \"name\":\"DhBRfeA5Io6M\", \"address\":\"8oFhky\", \"beds\":{\"$numberInt\":\"823\"}, \"availableBeds\":{\"$numberInt\":\"972\"}, \"location\":{\"id\":\"bLKmkpMpPcGZ\", \"name\":\"__3fr2fXfzg\", \"referenceId\":\"TYO3ELvVwB1p\", \"locationCategory\":\"PATIENT\", \"position\":{\"coordinates\":[{\"$numberDouble\":\"0.4898705821697036\"}, {\"$numberDouble\":\"0.8828660618090617\"}], \"type\":\"Point\"}}, \"patients\":[], \"products\":[{\"_id\":{\"timestamp\":{\"$numberInt\":\"18\"}, \"machineIdentifier\":{\"$numberInt\":\"-1727284081\"}, \"processIdentifier\":{\"$numberInt\":\"461\"}, \"counter\":{\"$numberInt\":\"842\"}}, \"name\":\"x3ma\", \"description\":\"0NXCvgvyftCME\", \"quantity\":{\"$numberInt\":\"323\"}, \"productType\":\"COMMON\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"-1461888299\"}, \"machineIdentifier\":{\"$numberInt\":\"75\"}, \"processIdentifier\":{\"$numberInt\":\"920\"}, \"counter\":{\"$numberInt\":\"864\"}}, \"name\":\"g5YVmYL\", \"description\":\"Hrz8J6rav\", \"quantity\":{\"$numberInt\":\"50\"}, \"productType\":\"BLOOD\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"481\"}, \"machineIdentifier\":{\"$numberInt\":\"467\"}, \"processIdentifier\":{\"$numberInt\":\"422\"}, \"counter\":{\"$numberInt\":\"713\"}}, \"name\":\"u9kcF\", \"description\":\"zBX\", \"quantity\":{\"$numberInt\":\"266\"}, \"productType\":\"BLOOD\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"137\"}, \"machineIdentifier\":{\"$numberInt\":\"605\"}, \"processIdentifier\":{\"$numberInt\":\"615\"}, \"counter\":{\"$numberInt\":\"721\"}}, \"name\":\"JrieOaTliNHWub\", \"description\":\"J4KppTk\", \"quantity\":{\"$numberInt\":\"719\"}, \"productType\":\"BLOOD\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"866\"}, \"machineIdentifier\":{\"$numberInt\":\"891\"}, \"processIdentifier\":{\"$numberInt\":\"324\"}, \"counter\":{\"$numberInt\":\"997\"}}, \"name\":\"\", \"description\":\"Ze01j_Mrsa4PajG8\", \"quantity\":{\"$numberInt\":\"855\"}, \"productType\":\"COMMON\"}], \"_id\":{\"$oid\":\"dbd3705ad9fd330dff017027\"}}")
            .and().insertInto("HospitalDB", "hospital_collection")
                .d("{\"id\":\"phDwXTsgf2x8q1\", \"name\":\"B_MRG\", \"address\":\"K\", \"beds\":{\"$numberInt\":\"130\"}, \"availableBeds\":{\"$numberInt\":\"123\"}, \"location\":{\"id\":\"Te\", \"name\":\"DsbH2TzY3nR\", \"referenceId\":\"4XBeyMiOz33L0L4k\", \"locationCategory\":\"HOSPITAL\", \"position\":{\"coordinates\":[{\"$numberDouble\":\"0.4412665587168473\"}, {\"$numberDouble\":\"0.013597438865606493\"}], \"type\":\"Point\"}}, \"patients\":[{\"id\":\"MBUsF8ZE\", \"name\":\"0LA_\", \"cpf\":\"BicpS6jGKgU_SErg\", \"birthDate\":{\"$date\":{\"$numberLong\":\"2101176000000\"}}, \"gender\":\"Q8JvZ\", \"entryDate\":{\"$date\":{\"$numberLong\":\"-1073242800000\"}}, \"exitDate\":{\"$date\":{\"$numberLong\":\"-317847600000\"}}, \"active\":true, \"location\":{\"id\":\"hpv\", \"name\":\"4s9RIrXVuLj\", \"referenceId\":\"F\", \"locationCategory\":\"PATIENT\", \"position\":{\"coordinates\":[{\"$numberDouble\":\"0.8192506430049518\"}, {\"$numberDouble\":\"0.5241907971735487\"}], \"type\":\"Point\"}}}, {\"id\":\"G2\", \"name\":\"k_EKeEGJ1GGOewy\", \"cpf\":\"we1TxHzpVZ5OiWYC\", \"birthDate\":{\"$date\":{\"$numberLong\":\"1793768400000\"}}, \"gender\":\"b7d9pFaYmTpu7\", \"entryDate\":{\"$date\":{\"$numberLong\":\"-1881342000000\"}}, \"exitDate\":{\"$date\":{\"$numberLong\":\"3952123200000\"}}, \"active\":true, \"location\":{\"id\":\"WqNDhd\", \"name\":\"fHbBuGracXjERQge\", \"referenceId\":\"T5ZoyQ\", \"locationCategory\":\"PATIENT\", \"position\":{\"coordinates\":[{\"$numberDouble\":\"0.20822769113315065\"}, {\"$numberDouble\":\"0.8150162485085497\"}], \"type\":\"Point\"}}}], \"products\":[{\"_id\":{\"timestamp\":{\"$numberInt\":\"750\"}, \"machineIdentifier\":{\"$numberInt\":\"846\"}, \"processIdentifier\":{\"$numberInt\":\"569\"}, \"counter\":{\"$numberInt\":\"715\"}}, \"name\":\"htvRsOnaFIxvU\", \"description\":\"Ott4MvMUkpKc\", \"quantity\":{\"$numberInt\":\"-123738037\"}, \"productType\":\"BLOOD\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"176\"}, \"machineIdentifier\":{\"$numberInt\":\"308\"}, \"processIdentifier\":{\"$numberInt\":\"617\"}, \"counter\":{\"$numberInt\":\"234\"}}, \"name\":\"nm\", \"description\":\"NjK4x7\", \"quantity\":{\"$numberInt\":\"154\"}, \"productType\":\"COMMON\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"724\"}, \"machineIdentifier\":{\"$numberInt\":\"19\"}, \"processIdentifier\":{\"$numberInt\":\"2\"}, \"counter\":{\"$numberInt\":\"296\"}}, \"name\":\"Y6QIqqUYS\", \"description\":\"tnrzx9Hq7Qm4YV\", \"quantity\":{\"$numberInt\":\"267\"}, \"productType\":\"BLOOD\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"274\"}, \"machineIdentifier\":{\"$numberInt\":\"563\"}, \"processIdentifier\":{\"$numberInt\":\"893\"}, \"counter\":{\"$numberInt\":\"295\"}}, \"name\":\"7mO\", \"description\":\"\", \"quantity\":{\"$numberInt\":\"279\"}, \"productType\":\"BLOOD\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"176\"}, \"machineIdentifier\":{\"$numberInt\":\"93\"}, \"processIdentifier\":{\"$numberInt\":\"487\"}, \"counter\":{\"$numberInt\":\"878\"}}, \"name\":\"bWvWn7vXSS_d\", \"description\":\"NJDK9\", \"quantity\":{\"$numberInt\":\"110\"}, \"productType\":\"BLOOD\"}], \"_id\":{\"$oid\":\"d594c1da7c9c190493c1adc0\"}}")
            .and().insertInto("HospitalDB", "hospital_collection")
                .d("{\"id\":\"\", \"name\":\"gwh9kYhgHBAjRiB\", \"address\":\"pdeK5mLWic\", \"beds\":{\"$numberInt\":\"431\"}, \"availableBeds\":{\"$numberInt\":\"187\"}, \"location\":{\"id\":\"L\", \"name\":\"foB\", \"referenceId\":\"m8Oyfqfq\", \"locationCategory\":\"PATIENT\", \"position\":{\"coordinates\":[{\"$numberDouble\":\"0.004843044184900225\"}, {\"$numberDouble\":\"0.013651485064669622\"}], \"type\":\"Point\"}}, \"patients\":[{\"id\":\"hXE3vHY4kvFFUV5\", \"name\":\"\", \"cpf\":\"qG\", \"birthDate\":{\"$date\":{\"$numberLong\":\"1030939200000\"}}, \"gender\":\"tgyjs\", \"entryDate\":{\"$date\":{\"$numberLong\":\"1133845200000\"}}, \"exitDate\":{\"$date\":{\"$numberLong\":\"3424910400000\"}}, \"active\":true, \"location\":{\"id\":\"14eP9qWN\", \"name\":\"\", \"referenceId\":\"S1t44juxh\", \"locationCategory\":\"HOSPITAL\", \"position\":{\"coordinates\":[{\"$numberDouble\":\"0.7505290661939329\"}, {\"$numberDouble\":\"0.04738885326741438\"}], \"type\":\"Point\"}}}, {\"id\":\"ihwfU_MAr\", \"name\":\"QrcMh4iCT\", \"cpf\":\"kRTKJmUk3gMXvk\", \"birthDate\":{\"$date\":{\"$numberLong\":\"-1384369200000\"}}, \"gender\":\"VPme\", \"entryDate\":{\"$date\":{\"$numberLong\":\"-229636800000\"}}, \"exitDate\":{\"$date\":{\"$numberLong\":\"3206577600000\"}}, \"active\":true, \"location\":{\"id\":\"5FU4lwExt5Z4ijIf\", \"name\":\"dAxHX8v\", \"referenceId\":\"sDg3fKz9rYRa4I9B\", \"locationCategory\":\"PATIENT\", \"position\":{\"coordinates\":[{\"$numberDouble\":\"0.6120739794996722\"}, {\"$numberDouble\":\"0.705102923520166\"}], \"type\":\"Point\"}}}], \"products\":[{\"_id\":{\"timestamp\":{\"$numberInt\":\"154\"}, \"machineIdentifier\":{\"$numberInt\":\"157\"}, \"processIdentifier\":{\"$numberInt\":\"672\"}, \"counter\":{\"$numberInt\":\"204\"}}, \"name\":\"ioBDK\", \"description\":\"HBYeF_\", \"quantity\":{\"$numberInt\":\"124\"}, \"productType\":\"BLOOD\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"653\"}, \"machineIdentifier\":{\"$numberInt\":\"739\"}, \"processIdentifier\":{\"$numberInt\":\"881\"}, \"counter\":{\"$numberInt\":\"314\"}}, \"name\":\"oEoK_s5Qu\", \"description\":\"hxM8rs\", \"quantity\":{\"$numberInt\":\"804\"}, \"productType\":\"COMMON\"}, {\"_id\":{\"timestamp\":{\"$numberInt\":\"114\"}, \"machineIdentifier\":{\"$numberInt\":\"174\"}, \"processIdentifier\":{\"$numberInt\":\"277\"}, \"counter\":{\"$numberInt\":\"183\"}}, \"name\":\"KfNsC8j6_\", \"description\":\"JI04x89oTH6fWoH8\", \"quantity\":{\"$numberInt\":\"119\"}, \"productType\":\"COMMON\"}], \"_id\":{\"$oid\":\"712ccd2beb804ae4859d780b\"}}")
            .dtos();
        MongoInsertionResultsDto insertionsresult = controller.execInsertionsIntoMongoDatabase(insertions);
        
        // Fault101. Received A Response From API With A Structure/Data That Is Not Matching Its Schema. Type: validation.response.status.unknown. Response status 400 not defined for path '/v1/hospitais/{id}/leitos'.
        given().accept("*/*")
                .header("x-EMextraHeader123", "")
                .get(baseUrlOfSut + "/v1/hospitais/_EM_1043_XYZ_/leitos?EMextraParam123=42")
                .then()
                .statusCode(400)
                .assertThat()
                .contentType("application/json")
                .body("'status'", numberMatches(400.0))
                .body("'error'", containsString("Bad Request"))
                .body("'message'", containsString("Hospital não encontrado! ID:_EM_1043_XYZ_"))
                .body("'path'", containsString("/v1/hospitais/_EM_1043_XYZ_/leitos"));
        
        // Fault101. Received A Response From API With A Structure/Data That Is Not Matching Its Schema. Type: validation.response.status.unknown. Response status 400 not defined for path '/v1/hospitais/{hospital_id}'.
        given().accept("*/*")
                .header("x-EMextraHeader123", "42")
                .delete(baseUrlOfSut + "/v1/hospitais/C0Le?EMextraParam123=_EM_1047_XYZ_")
                .then()
                .statusCode(400)
                .assertThat()
                .body(isEmptyOrNullString());
        
        // Fault101. Received A Response From API With A Structure/Data That Is Not Matching Its Schema. Type: validation.response.status.unknown. Response status 400 not defined for path '/v1/hospitais/{id}/leitos'.
        given().accept("*/*")
                .header("x-EMextraHeader123", "_EM_1046_XYZ_")
                .get(baseUrlOfSut + "/v1/hospitais/RVjD0vy7qkXTwvaP/leitos")
                .then()
                .statusCode(400)
                .assertThat()
                .contentType("application/json")
                .body("'status'", numberMatches(400.0))
                .body("'error'", containsString("Bad Request"))
                .body("'message'", containsString("Hospital não encontrado! ID:RVjD0vy7qkXTwvaP"))
                .body("'path'", containsString("/v1/hospitais/RVjD0vy7qkXTwvaP/leitos"));
        
        given().accept("*/*")
                .header("x-EMextraHeader123", "")
                .contentType("application/json")
                .body(" 4upAmmxvyS7RW ")
                .post(baseUrlOfSut + "/v1/hospitais/4upAmmxvyS7RW/pacientes/checkout")
                .then()
                .statusCode(404)
                .assertThat()
                .body(isEmptyOrNullString());
    }
}
